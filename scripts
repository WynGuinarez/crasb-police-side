#!/usr/bin/env node

/**
 * Setup Verification Script
 * Checks if the project is properly configured
 */

const fs = require('fs');
const path = require('path');

console.log('üîç Checking project setup...\n');

let allGood = true;

// Check Node.js version
const nodeVersion = process.version;
const majorVersion = parseInt(nodeVersion.slice(1).split('.')[0]);
if (majorVersion < 18) {
  console.log('‚ùå Node.js version:', nodeVersion, '(Need 18+)');
  allGood = false;
} else {
  console.log('‚úÖ Node.js version:', nodeVersion);
}

// Check if node_modules exists
if (!fs.existsSync('node_modules')) {
  console.log('‚ùå node_modules not found. Run: npm install');
  allGood = false;
} else {
  console.log('‚úÖ Dependencies installed');
}

// Check if .env.local exists
if (!fs.existsSync('.env.local')) {
  console.log('‚ö†Ô∏è  .env.local not found');
  console.log('   Create it by copying .env.example or manually');
  console.log('   Windows: Copy-Item .env.example .env.local');
  console.log('   Mac/Linux: cp .env.example .env.local');
} else {
  console.log('‚úÖ .env.local exists');
  
  // Check if Firebase config is set
  const envContent = fs.readFileSync('.env.local', 'utf8');
  if (envContent.includes('your-api-key') || envContent.includes('your-project')) {
    console.log('‚ö†Ô∏è  .env.local contains placeholder values');
    console.log('   Update with your actual Firebase credentials');
  } else if (envContent.includes('NEXT_PUBLIC_FIREBASE_API_KEY=') && !envContent.includes('NEXT_PUBLIC_FIREBASE_API_KEY=your')) {
    console.log('‚úÖ Firebase configuration appears to be set');
  }
}

// Check if lib/firebase-config.ts exists
if (!fs.existsSync('lib/firebase-config.ts')) {
  console.log('‚ö†Ô∏è  lib/firebase-config.ts not found');
  allGood = false;
} else {
  console.log('‚úÖ Firebase config file exists');
}

// Check if pages/_app.tsx has Firebase initialization
if (fs.existsSync('pages/_app.tsx')) {
  const appContent = fs.readFileSync('pages/_app.tsx', 'utf8');
  if (appContent.includes('initializeFirebaseGlobals')) {
    console.log('‚úÖ Firebase initialization in _app.tsx');
  } else {
    console.log('‚ö†Ô∏è  Firebase initialization may be missing in _app.tsx');
  }
}

console.log('\n' + '='.repeat(50));
if (allGood) {
  console.log('‚úÖ Setup looks good! Run: npm run dev');
} else {
  console.log('‚ö†Ô∏è  Some issues found. Please fix them before running the app.');
}
console.log('='.repeat(50));

